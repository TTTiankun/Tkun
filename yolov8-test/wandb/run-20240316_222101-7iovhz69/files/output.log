[34m[1mAMP: [39m[22mrunning Automatic Mixed Precision (AMP) checks with YOLOv8n...
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mtrain: [39m[22mNew cache created: /home/jason/Desktop/datasets/number_datasets/train.cache
[34m[1mval: [39m[22mNew cache created: /home/jason/Desktop/datasets/number_datasets/test.cache
[34m[1moptimizer:[39m[22m 'optimizer=auto' found, ignoring 'lr0=0.01' and 'momentum=0.937' and determining best 'optimizer', 'lr0' and 'momentum' automatically...
[34m[1moptimizer:[39m[22m AdamW(lr=0.000714, momentum=0.9) with parameter groups 26 weight(decay=0.0), 27 weight(decay=0.00040625000000000004), 27 bias(decay=0.0)
[34m[1mtrain: [39m[22mScanning /home/jason/Desktop/datasets/number_datasets/train... 15909 images, 0 corrupt: 100%|██████████| 15909/15909 [0
[34m[1mval: [39m[22mScanning /home/jason/Desktop/datasets/number_datasets/test... 504 images, 0 corrupt: 100%|██████████| 504/504 [00:00<00:0
[34m[1mTensorBoard: [39m[22mmodel graph visualization added ✅
Image sizes 640 train, 640 val
Using 8 dataloader workers
Logging results to [1mruns/classify/train
Starting training for 30 epochs...
      Epoch    GPU_mem       loss  Instances       Size

































       1/30      2.34G      1.292         26        640:  99%|█████████▉| 605/612 [01:06<00:00,  9.38it/s]
       1/30      2.34G      1.284         23        640: 100%|██████████| 612/612 [01:07<00:00,  9.03it/s]
               classes   top1_acc   top5_acc: 100%|██████████| 10/10 [00:00<00:00, 11.84it/s]
      Epoch    GPU_mem       loss  Instances       Size
































       2/30      2.32G     0.4161         26        640:  99%|█████████▉| 608/612 [01:04<00:00,  9.60it/s]
                   all       0.95          1
       2/30      2.32G     0.4152         23        640: 100%|██████████| 612/612 [01:04<00:00,  9.42it/s]
               classes   top1_acc   top5_acc: 100%|██████████| 10/10 [00:00<00:00, 12.25it/s]
































       3/30      2.32G     0.2709         26        640:  99%|█████████▉| 607/612 [01:04<00:00,  9.44it/s]
                   all      0.968          1
       3/30      2.32G     0.2699         23        640: 100%|██████████| 612/612 [01:04<00:00,  9.45it/s]
               classes   top1_acc   top5_acc: 100%|██████████| 10/10 [00:00<00:00, 11.66it/s]
































       4/30      2.32G     0.2153         23        640: 100%|██████████| 612/612 [01:05<00:00,  9.38it/s]
               classes   top1_acc   top5_acc: 100%|██████████| 10/10 [00:00<00:00, 11.73it/s]
                   all       0.98          1
      Epoch    GPU_mem       loss  Instances       Size































       5/30      2.32G     0.1546         23        640: 100%|██████████| 612/612 [01:05<00:00,  9.35it/s]
               classes   top1_acc   top5_acc:  10%|█         | 1/10 [00:00<00:01,  8.51it/s]
                   all      0.996          1
               classes   top1_acc   top5_acc: 100%|██████████| 10/10 [00:00<00:00, 11.79it/s]

































       6/30      2.32G     0.1466         26        640: 100%|█████████▉| 611/612 [01:07<00:00,  9.34it/s]
                   all      0.992          1
       6/30      2.32G     0.1464         23        640: 100%|██████████| 612/612 [01:07<00:00,  9.07it/s]
               classes   top1_acc   top5_acc: 100%|██████████| 10/10 [00:00<00:00, 11.85it/s]
































       7/30      2.32G     0.1337         26        640: 100%|█████████▉| 609/612 [01:04<00:00,  9.46it/s]
                   all      0.996          1
       7/30      2.32G     0.1334         23        640: 100%|██████████| 612/612 [01:04<00:00,  9.45it/s]
               classes   top1_acc   top5_acc: 100%|██████████| 10/10 [00:00<00:00, 11.87it/s]
       8/30      2.32G     0.1273         26        640:   2%|▏         | 14/612 [00:01<01:03,  9.38it/s]Exception in thread Thread-17 (_pin_memory_loop):
Traceback (most recent call last):
  File "/home/jason/.conda/envs/yolo/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
  File "/home/jason/.conda/envs/yolo/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
  File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/torch/utils/data/_utils/pin_memory.py", line 54, in _pin_memory_loop
    do_one_step()
  File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/torch/utils/data/_utils/pin_memory.py", line 31, in do_one_step
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jason/.conda/envs/yolo/lib/python3.11/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/torch/multiprocessing/reductions.py", line 355, in rebuild_storage_fd
       8/30      2.32G     0.1273         26        640:   2%|▏         | 14/612 [00:01<01:09,  8.58it/s]
    fd = df.detach()
         ^^^^^^^^^^^
  File "/home/jason/.conda/envs/yolo/lib/python3.11/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
Traceback (most recent call last):
    File "/home/jason/Desktop/yolov8-test/train_yolov8_cls.py", line 10, in <module>
    results = model.train(data=data_path, epochs=30,device='0',
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
       File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/ultralytics/engine/model.py", line 655, in train
    self.trainer.train()
  ^  File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/ultralytics/engine/trainer.py", line 213, in train
    self._do_train(world_size)
^^^^^^^^^^^^^^^^^^^^^  File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/ultralytics/engine/trainer.py", line 393, in _do_train
    self.optimizer_step()
^^  File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/ultralytics/engine/trainer.py", line 535, in optimizer_step
    self.scaler.step(self.optimizer)
^^^^^^^^^^^^^^^^^  File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/torch/cuda/amp/grad_scaler.py", line 416, in step
    retval = self._maybe_opt_step(optimizer, optimizer_state, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/torch/cuda/amp/grad_scaler.py", line 314, in _maybe_opt_step
    if not sum(v.item() for v in optimizer_state["found_inf_per_device"].values()):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jason/.conda/envs/yolo/lib/python3.11/multiprocessing/resource_sharer.py", line 86, in get_connection
  File "/home/jason/.conda/envs/yolo/lib/python3.11/site-packages/torch/cuda/amp/grad_scaler.py", line 314, in <genexpr>
    if not sum(v.item() for v in optimizer_state["found_inf_per_device"].values()):
               ^^^^^^^^
KeyboardInterrupt